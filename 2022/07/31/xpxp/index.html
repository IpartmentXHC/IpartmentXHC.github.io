<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="萧禾财">
    
    <title>
        
            xpxp |
        
        XHC BLOG
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.svg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":false,"expand_all":false,"init_open":true},"style":{"primary_color":"#1772b4","avatar":"/images/avatar.svg","favicon":"/images/logo.svg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"Keep writing and Keep loving."},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":false},"lazyload":{"enable":true},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
  </script>
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                XHC BLOG
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                分类
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">分类</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">xpxp</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.svg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">萧禾财</span>
                        
                            <span class="author-label">Lv4</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2022-07-31 12:52:42</span>
        <span class="mobile">2022-07-31 12:52</span>
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/%E6%AF%94%E8%B5%9BWP/">比赛WP</a>&nbsp;
                    </li>
                
                    <li>
                        &gt; <a href="/categories/%E6%AF%94%E8%B5%9BWP/2022CISCN%E5%8D%8E%E4%B8%AD%E5%88%86%E5%8C%BA%E8%B5%9B/">2022CISCN华中分区赛</a>&nbsp;
                    </li>
                
                    <li>
                        &gt; <a href="/categories/%E6%AF%94%E8%B5%9BWP/2022CISCN%E5%8D%8E%E4%B8%AD%E5%88%86%E5%8C%BA%E8%B5%9B/misc/">misc</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>1.9k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>10 分钟</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h1 id=""><a href="#" class="headerlink" title=""></a></h1><h2 id="观察题目"><a href="#观察题目" class="headerlink" title="观察题目"></a>观察题目</h2><p>给了一个raw文件 一般对于题要用 volatility内存取证工具</p>
<blockquote>
<p><a class="link"   target="_blank" rel="noopener" href="https://www.volatilityfoundation.org/releases" >官网下载地址<i class="fas fa-external-link-alt"></i></a>  不建议下载3.0版本 还不稳定</p>
<p>我是在windows系统上运行的，以下命令都是在win命令</p>
</blockquote>
<p>首先查看系统的属性</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">PS D:\CTF\22年国赛\复赛\misc\已解\xpxp\volatility_2.6_win64_standalone&gt; .\volatility_2.6_win64_standalone.exe -f xpxp.raw kdbgscan</span><br><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">**************************************************</span><br><span class="line">Instantiating KDBG using: Kernel AS WinXPSP2x86 (5.1.0 32bit)</span><br><span class="line">Offset (V)                    : 0x80546ae0</span><br><span class="line">Offset (P)                    : 0x546ae0</span><br><span class="line">KDBG owner tag check          : True</span><br><span class="line">Profile suggestion (KDBGHeader): WinXPSP3x86</span><br><span class="line">Version64                     : 0x80546ab8 (Major: 15, Minor: 2600)</span><br><span class="line">Service Pack (CmNtCSDVersion) : 3</span><br><span class="line">Build string (NtBuildLab)     : 2600.xpsp.080413-2111</span><br><span class="line">PsActiveProcessHead           : 0x8055b158 (35 processes)</span><br><span class="line">PsLoadedModuleList            : 0x80554fc0 (123 modules)</span><br><span class="line">KernelBase                    : 0x804d8000 (Matches MZ: True)</span><br><span class="line">Major (OptionalHeader)        : 5</span><br><span class="line">Minor (OptionalHeader)        : 1</span><br><span class="line">KPCR                          : 0xffdff000 (CPU 0)</span><br><span class="line"></span><br><span class="line">**************************************************</span><br><span class="line">Instantiating KDBG using: Kernel AS WinXPSP2x86 (5.1.0 32bit)</span><br><span class="line">Offset (V)                    : 0x80546ae0</span><br><span class="line">Offset (P)                    : 0x546ae0</span><br><span class="line">KDBG owner tag check          : True</span><br><span class="line">Profile suggestion (KDBGHeader): WinXPSP2x86</span><br><span class="line">Version64                     : 0x80546ab8 (Major: 15, Minor: 2600)</span><br><span class="line">Service Pack (CmNtCSDVersion) : 3</span><br><span class="line">Build string (NtBuildLab)     : 2600.xpsp.080413-2111</span><br><span class="line">PsActiveProcessHead           : 0x8055b158 (35 processes)</span><br><span class="line">PsLoadedModuleList            : 0x80554fc0 (123 modules)</span><br><span class="line">KernelBase                    : 0x804d8000 (Matches MZ: True)</span><br><span class="line">Major (OptionalHeader)        : 5</span><br><span class="line">Minor (OptionalHeader)        : 1</span><br><span class="line">KPCR                          : 0xffdff000 (CPU 0)</span><br></pre></td></tr></table></figure>

<p>可以发现系统最大可能是WinXPSP2x86，接下来我们取查看运行的进程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">PS D:\CTF\22年国赛\复赛\misc\已解\xpxp\volatility_2.6_win64_standalone&gt; .\volatility_2.6_win64_standalone.exe -f xpxp.raw --profile=WinXPSP2x86 pslist</span><br><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">Offset(V)  Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit</span><br><span class="line">---------- -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------</span><br><span class="line">0x821b9830 System                    4      0     59      252 ------      0</span><br><span class="line">0x81cc2020 smss.exe                540      4      3       19 ------      0 2022-05-20 03:06:37 UTC+0000</span><br><span class="line">0x82013da0 csrss.exe               608    540     11      447      0      0 2022-05-20 03:06:40 UTC+0000</span><br><span class="line">0x82012ca8 winlogon.exe            632    540     23      459      0      0 2022-05-20 03:06:40 UTC+0000</span><br><span class="line">0x81c9dda0 services.exe            676    632     16      274      0      0 2022-05-20 03:06:41 UTC+0000</span><br><span class="line">0x820eb1c8 lsass.exe               688    632     24      356      0      0 2022-05-20 03:06:41 UTC+0000</span><br><span class="line">0x81f4eda0 vmacthlp.exe            900    676      1       25      0      0 2022-05-20 03:06:41 UTC+0000</span><br><span class="line">0x81fe7240 svchost.exe             916    676     19      198      0      0 2022-05-20 03:06:41 UTC+0000</span><br><span class="line">0x81e1dda0 svchost.exe             996    676      9      274      0      0 2022-05-20 03:06:41 UTC+0000</span><br><span class="line">0x81dc5da0 svchost.exe            1136    676     66     1215      0      0 2022-05-20 03:06:41 UTC+0000</span><br><span class="line">0x820f4020 svchost.exe            1184    676      5       67      0      0 2022-05-20 03:06:41 UTC+0000</span><br><span class="line">0x81ec87e8 svchost.exe            1236    676     15      196      0      0 2022-05-20 03:06:42 UTC+0000</span><br><span class="line">0x81d24c10 spoolsv.exe            1532    676     14      130      0      0 2022-05-20 03:06:44 UTC+0000</span><br><span class="line">0x81ca5da0 explorer.exe           1808   1748     17      448      0      0 2022-05-20 03:06:54 UTC+0000</span><br><span class="line">0x82102c18 rundll32.exe           1936   1808      4       78      0      0 2022-05-20 03:06:55 UTC+0000</span><br><span class="line">0x81ff5da0 vmtoolsd.exe           1944   1808      5      202      0      0 2022-05-20 03:06:55 UTC+0000</span><br><span class="line">0x81d7e448 ctfmon.exe             1952   1808      1      110      0      0 2022-05-20 03:06:55 UTC+0000</span><br><span class="line">0x820ad378 msmsgs.exe             1980   1808      5      162      0      0 2022-05-20 03:06:55 UTC+0000</span><br><span class="line">0x820ac470 svchost.exe             212    676      5       87      0      0 2022-05-20 03:07:00 UTC+0000</span><br><span class="line">0x81c10228 VGAuthService.e         328    676      2       60      0      0 2022-05-20 03:07:00 UTC+0000</span><br><span class="line">0x81f8b410 vmtoolsd.exe            512    676      9      261      0      0 2022-05-20 03:07:08 UTC+0000</span><br><span class="line">0x821022e0 wmiprvse.exe           1108    916     13      241      0      0 2022-05-20 03:07:08 UTC+0000</span><br><span class="line">0x820c8660 wscntfy.exe            1572   1136      1       39      0      0 2022-05-20 03:07:08 UTC+0000</span><br><span class="line">0x81d41da0 alg.exe                1416    676      7      104      0      0 2022-05-20 03:07:09 UTC+0000</span><br><span class="line">0x81da1da0 wordpad.exe             244   1808      2      100      0      0 2022-05-20 03:07:09 UTC+0000</span><br><span class="line">0x81fedda0 notepad.exe             236   1808      1       50      0      0 2022-05-20 03:07:14 UTC+0000</span><br><span class="line">0x81f33508 mspaint.exe             680   1808      5      120      0      0 2022-05-20 03:07:36 UTC+0000</span><br><span class="line">0x820134b8 svchost.exe            1096    676      8      132      0      0 2022-05-20 03:07:36 UTC+0000</span><br><span class="line">0x81ecb2c0 wuauclt.exe             404   1136      8      173      0      0 2022-05-20 03:07:53 UTC+0000</span><br><span class="line">0x81d5dda0 notepad.exe             372    528      1       50      0      0 2022-05-20 03:08:03 UTC+0000</span><br><span class="line">0x81c12da0 wuauclt.exe             752   1136      5      139      0      0 2022-05-20 03:08:08 UTC+0000</span><br><span class="line">0x8211e438 notepad.exe             132   1808      1       50      0      0 2022-05-20 03:08:08 UTC+0000</span><br><span class="line">0x8207b020 notepad.exe            2060   1808      1       50      0      0 2022-05-20 03:08:18 UTC+0000</span><br><span class="line">0x81ca27f0 DumpIt.exe             2304   1808      1       29      0      0 2022-05-20 03:09:00 UTC+0000</span><br><span class="line">0x81ffc6e8 conime.exe             2316   2304      1       38      0      0 2022-05-20 03:09:00 UTC+0000</span><br></pre></td></tr></table></figure>

<p>我们可以发现使用过notepad(记事本)程序，将记事本中的内容输出出来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">PS D:\CTF\22年国赛\复赛\misc\已解\xpxp\volatility_2.6_win64_standalone&gt; .\volatility_2.6_win64_standalone.exe -f xpxp.raw --profile=WinXPSP2x86 notepad</span><br><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">Process: 236</span><br><span class="line">Text:</span><br><span class="line">?</span><br><span class="line"></span><br><span class="line">Text:</span><br><span class="line">d</span><br><span class="line"></span><br><span class="line">Text:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Text:</span><br><span class="line">?</span><br><span class="line"></span><br><span class="line">Text:</span><br><span class="line">??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????</span><br><span class="line"></span><br><span class="line">Process: 372</span><br><span class="line">Text:</span><br><span class="line">?</span><br><span class="line"></span><br><span class="line">Text:</span><br><span class="line">d</span><br><span class="line"></span><br><span class="line">Text:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Text:</span><br><span class="line">?</span><br><span class="line"></span><br><span class="line">Text:</span><br><span class="line">f = open(&#x27;./flag.zip&#x27;, &#x27;rb&#x27;).read()</span><br><span class="line">new = open(&#x27;./fffflllaag.dat&#x27;, &#x27;ab&#x27;)</span><br><span class="line"></span><br><span class="line">letter = &#x27;&#x27;</span><br><span class="line">secret = int(letter,16)</span><br><span class="line">print(secret)</span><br><span class="line">for i in f:</span><br><span class="line">    n = int(i) ^ secret</span><br><span class="line">    new.write(int(n).to_bytes(1, &#x27;big&#x27;))</span><br><span class="line"></span><br><span class="line">Process: 132</span><br><span class="line">Text:</span><br><span class="line">?</span><br><span class="line"></span><br><span class="line">Text:</span><br><span class="line">d</span><br><span class="line"></span><br><span class="line">Text:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Text:</span><br><span class="line">?</span><br><span class="line"></span><br><span class="line">Text:</span><br><span class="line">According to Homer&#x27;s epic, the hero Achilles is the precious son of the mortal Polus and the beautiful fairy Thetis.</span><br><span class="line">It is said that her mother Tethys carried him upside down into the Styx river when he was just born, so that he could be invulnerable.</span><br><span class="line">Unfortunately, due to the rapid flow of the Ming River, his mother didn&#x27;t dare to let go of his heel.</span><br><span class="line">The heel held by his mother was accidentally exposed outside the water, so the heel was the most vulnerable place, leaving the only &quot;dead hole&quot; in his body, so he buried the disaster.</span><br><span class="line">When he grew up, Achilles fought bravely. When he went to attack the city of Troy (the story of Trojan horse slaughtering the city), the brave Achilles singled out the Trojan general Hector, killed him and dragged his body to demonstrate.</span><br><span class="line">But later, after conquering Troy, Achilles was attacked by an arrow by Hector&#x27;s brother-in-law Paris and hit his ankle - the hero fell to the ground and died at the moment of shaking.</span><br><span class="line">ankle, ankle, I love ankle.The password is ??k1eAn???</span><br><span class="line"></span><br><span class="line">Process: 2060</span><br><span class="line">Text:</span><br><span class="line">?</span><br><span class="line"></span><br><span class="line">Text:</span><br><span class="line">d</span><br><span class="line"></span><br><span class="line">Text:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Text:</span><br><span class="line">?</span><br><span class="line"></span><br><span class="line">Text:</span><br><span class="line">???????????????????????????????XOR?EOR????????????????????????????????letter?????????????????????????</span><br></pre></td></tr></table></figure>

<p>提出关键信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">//可能python代码</span><br><span class="line">f = open(&#x27;./flag.zip&#x27;, &#x27;rb&#x27;).read()</span><br><span class="line">new = open(&#x27;./fffflllaag.dat&#x27;, &#x27;ab&#x27;)</span><br><span class="line"></span><br><span class="line">letter = &#x27;&#x27;</span><br><span class="line">secret = int(letter,16)</span><br><span class="line">print(secret)</span><br><span class="line">for i in f:</span><br><span class="line">    n = int(i) ^ secret</span><br><span class="line">    new.write(int(n).to_bytes(1, &#x27;big&#x27;))</span><br><span class="line"> </span><br><span class="line">//提示password</span><br><span class="line">ankle, ankle, I love ankle.The password is ??k1eAn???</span><br></pre></td></tr></table></figure>

<p>记事本中提到两个重要文件 <strong>.&#x2F;flag.zip</strong>和**.&#x2F;fffflllaag.dat**</p>
<p>我们搜寻一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS D:\CTF\22年国赛\复赛\misc\已解\xpxp\volatility_2.6_win64_standalone&gt; .\volatility_2.6_win64_standalone.exe -f xpxp.raw --profile=WinXPSP2x86 filescan | findstr flag</span><br><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">0x000000000240cad8      1      0 R--rw- \Device\HarddiskVolume1\Documents and Settings\All Users\Documents\flagData.zip</span><br></pre></td></tr></table></figure>

<p>我们找到一个有关flag的一个文件</p>
<p>把它提取出来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS D:\CTF\22年国赛\复赛\misc\已解\xpxp\volatility_2.6_win64_standalone&gt; .\volatility_2.6_win64_standalone.exe -f xpxp.raw --profile=WinXPSP2x86 dumpfiles -Q 0x000000000240cad8 -D ./</span><br><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">DataSectionObject 0x0240cad8   None   \Device\HarddiskVolume1\Documents and Settings\All Users\Documents\flagData.zip</span><br></pre></td></tr></table></figure>

<p>得到一个dat文件</p>
<p>直接在kali中用foremost指令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ foremost file.None.0x81d20978.dat </span><br><span class="line">Processing: file.None.0x81d20978.dat</span><br><span class="line">|foundat=fffflllaag.dat�r����b���j��w�e��..�p f�b��I��U�+������������������;��x�&#123;�1�8�e��J�eN�oV*��m��u�f��/�����Rl�3U(�2����e��-~=���y�y�OȽ[U3W�[&#125;H00DQ�Rfʃi�7�O�Y-��2�B��l�#/����9D�p9V�</span><br><span class="line">                                      ��4��</span><br><span class="line">                                           Pn.!�:�a���at�N�p���(G~�rn�| ��</span><br><span class="line">*|</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p>得到dat文件中隐藏的zip压缩包</p>
<p>随后我们便能看见fffflllaag.dat文件</p>
<p>根据我们得到的python代码 可知原文件应该是zip文件，zip文件与secret进行异或就得到了dat文件</p>
<p>dat文件头为<strong>5A 41</strong> zip文件的文件头为<strong>50 4B</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0X5A ^ 0X50 = 0X0A</span><br><span class="line">0X41 ^ 0X48 = 0X0A</span><br></pre></td></tr></table></figure>

<p>所以secret应该为 0x0A</p>
<p>我们用010打开dat文件</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://raw.githubusercontent.com/IpartmentXHC/image/master/202207311335504.png"
                      alt="image-20220731133518449"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://raw.githubusercontent.com/IpartmentXHC/image/master/202207311335662.png"
                      alt="image-20220731133550622"
                ></p>
<p>异或后更改文件后缀为zip</p>
<p>并不是伪加密 需要密码</p>
<p>根据记事本中的提示我们有两种方法获得密码</p>
<h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>利用工具ARCHPR掩码爆破</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://raw.githubusercontent.com/IpartmentXHC/image/master/202207311342142.png"
                      alt="image-20220731134243110"
                ></p>
<p>时间很长</p>
<p>大概要半个小时</p>
<p>可以爆出密码</p>
<p><strong>Ank1eAnk1e</strong></p>
<h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p><strong>猜</strong></p>
<p>??k1eAn??? 就很像两个ankle连在一起 </p>
<p><strong>Ank1eAnk1e</strong></p>
<h2 id="得flag"><a href="#得flag" class="headerlink" title="得flag"></a>得flag</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">The answer to egg1 is : You are the only weakness in my body</span><br><span class="line">This is also the answer to flag</span><br></pre></td></tr></table></figure>

<p>直接提交**flag{You are the only weakness in my body}**不对 </p>
<p>看来我们还需要找出问题egg1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">PS D:\CTF\22年国赛\复赛\misc\已解\xpxp\volatility_2.6_win64_standalone&gt; .\volatility_2.6_win64_standalone.exe -f xpxp.raw --profile=WinXPSP2x86 filescan | findstr egg</span><br><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">0x00000000020273b8      1      0 R--rwd \Device\HarddiskVolume1\Program Files\xerox\egg4.txt</span><br><span class="line">0x00000000020cb2b8      1      0 RW-rw- \Device\HarddiskVolume1\Documents and Settings\Administrator\Recent\egg4.lnk</span><br><span class="line">0x0000000002137248      1      0 R--r-- \Device\HarddiskVolume1\Documents and Settings\Administrator\My Documents\egg1.rtf</span><br><span class="line">0x000000000214c450      1      0 RW-rw- \Device\HarddiskVolume1\Documents and Settings\Administrator\Recent\egg5.lnk</span><br><span class="line">0x00000000022c4d08      1      0 RW-rw- \Device\HarddiskVolume1\Documents and Settings\Administrator\Recent\egg1.lnk</span><br><span class="line">0x000000000231e748      1      0 RW-rw- \Device\HarddiskVolume1\Documents and Settings\Administrator\Recent\egg3.lnk</span><br><span class="line">0x000000000232d938      1      0 R--rwd \Device\HarddiskVolume1\Program Files\Messenger\egg5.txt</span><br><span class="line">0x0000000002409e28      1      0 R--rwd \Device\HarddiskVolume1\Documents and Settings\Administrator\My Documents\My Pictures\egg3.bmp</span><br><span class="line">0x000000000251c538      1      0 R--rwd \Device\HarddiskVolume1\Documents and Settings\Administrator\My Documents\My Music\egg2.txt</span><br></pre></td></tr></table></figure>

<p>把egg1.rtf文件dump出来</p>
<p>用写字板打开</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Do you know what the Chinese meaning of ankle is? flag is that.</span><br><span class="line"></span><br><span class="line">Remember to convert the answer to a 32-bit lowercase MD5 value.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>原来如此 将answer MD5 32小写加密</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;47155018947fbed1987313fe2d02e0bb&#125;</span><br></pre></td></tr></table></figure>


        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>本文标题：xpxp</li>
        <li>本文作者：萧禾财</li>
        <li>创建时间：2022-07-31 12:52:42</li>
        <li>
            本文链接：https://ipartmentxhc.github.io/2022/07/31/xpxp/
        </li>
        <li>
            版权声明：本博客所有文章除特别声明外，均采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> 许可协议。转载请注明出处！
        </li>
    </ul>
</div>

            </div>
        

        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2022/07/31/BlueBird-apk2/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">BlueBird_apk2</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2022/07/29/meikyu2/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">meikyu2</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2022</span>
              -
            
            2023&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">萧禾财</a>
        </div>
        
            <script async  src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        访问人数&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-text"></span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%82%E5%AF%9F%E9%A2%98%E7%9B%AE"><span class="nav-text">观察题目</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80"><span class="nav-text">方法一</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="nav-text">方法二</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BE%97flag"><span class="nav-text">得flag</span></a></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/code-copy.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/lazyload.js"></script>


<div class="post-scripts">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/toc.js"></script>
    
</div>



</body>
</html>
